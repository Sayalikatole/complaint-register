<!-- <header class="flex items-center justify-between bg-indigo-900 p-2 text-white">
    <div class="flex items-center space-x-8">
      <div class="px-4">
        <i class="fas fa-headset text-2xl"></i>
      </div>
      <nav class="flex space-x-6">
        <ng-container *ngIf="role === 'admin'; else userNav">
          <a routerLink="/admin/tickets" class="py-2 hover:border-b-2 hover:border-white">Tickets</a>
          <a routerLink="/admin/feedback" class="py-2 hover:border-b-2 hover:border-white">Feedback</a>
          <a routerLink="/admin/analytics" class="py-2 hover:border-b-2 hover:border-white">Analytics</a>
        </ng-container>
  
        <ng-template #userNav>
          <a routerLink="/user/complaints" class="py-2 hover:border-b-2 hover:border-white">Complaints</a>
          <a routerLink="/user/suggestions" class="py-2 hover:border-b-2 hover:border-white">Suggestions</a>
          <a routerLink="/user/analytics" class="py-2 hover:border-b-2 hover:border-white">Analytics</a>
        </ng-template>
      </nav>
    </div>
  
    <div class="flex items-center space-x-4 pr-4">
      <span>Micropro</span>
      <div class="relative">
        <button class="flex items-center rounded bg-blue-600 px-2 py-1 text-white hover:bg-blue-700">
          <i class="fas fa-plus mr-1"></i>
          <span class="hidden md:inline">New</span>
          <i class="fas fa-chevron-down ml-1 text-xs"></i>
        </button>
      </div>
      <i class="fas fa-search"></i>
      <i class="far fa-bell"></i>
      <i class="fas fa-cog"></i>
      <div class="flex h-8 w-8 items-center justify-center rounded-full bg-blue-500">
        <span>RE</span>
      </div>
    </div>
  </header> -->

<!-- Modern Responsive Navbar -->
<!-- Modern Responsive Navbar -->
<!-- Professional Enterprise-Grade Navbar -->
<header class="bg-gradient-to-r from-slate-800 via-slate-700 to-slate-800 shadow-lg border-b border-slate-600">
  <!-- Desktop Navbar -->
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex items-center justify-between h-16">
      <!-- Left Side - Logo & Primary Navigation -->
      <div class="flex items-center cursor-pointer">
        <div class="flex items-center mr-4">
          <button (click)="toggleSidebar.emit()" class="text-white hover:bg-indigo-500 p-2 rounded-md">
            <i class="fas" [ngClass]="sidebarOpen ? 'fa-indent' : 'fa-outdent'"></i>
          </button>
        </div>
        <!-- Logo with animation -->
        <!-- Animated logo with hover effect -->
        <div class="flex-shrink-0 flex items-center group">
          <div class="transition-all duration-300 group-hover:scale-105">
            <!-- Full inline SVG logo with text -->
            <svg width="180" height="42" viewBox="0 0 369.6417910447761 86.94025420971562" class="filter drop-shadow">
              <defs id="SvgjsDefs2555">
                <linearGradient id="SvgjsLinearGradient2560">
                  <stop id="SvgjsStop2561" stop-color="#7f00ff" offset="0"></stop>
                  <stop id="SvgjsStop2562" stop-color="#e100ff" offset="1"></stop>
                </linearGradient>
                <linearGradient id="SvgjsLinearGradient2563">
                  <stop id="SvgjsStop2564" stop-color="#7f00ff" offset="0"></stop>
                  <stop id="SvgjsStop2565" stop-color="#e100ff" offset="1"></stop>
                </linearGradient>
              </defs>
              <g id="SvgjsG2556" featurekey="symbolFeature-0"
                transform="matrix(0.2014707210389788,0,0,0.2014707210389788,-11.57187462820122,-7.254758197852036)"
                fill="url(#SvgjsLinearGradient2560)">
                <g xmlns="http://www.w3.org/2000/svg">
                  <path fill="url(#SvgjsLinearGradient2560)"
                    d="M435.17,317.35c-3.287,0-6.238,1.426-8.287,3.685l-116.105-43.858c2.469-6.173,3.838-12.901,3.838-19.954   c0-3.084-0.272-6.101-0.77-9.041l41.753-12.034c4.901,10.298,15.399,17.415,27.563,17.415c16.857,0,30.516-13.662,30.516-30.517   s-13.658-30.517-30.516-30.517c-16.854,0-30.518,13.662-30.518,30.517c0,1.443,0.111,2.86,0.303,4.251l-41.574,11.938   C304.883,220.945,290,207.208,269,204.098V103.145c16-3.401,26.674-16.949,26.674-33.152c0-18.77-15.138-33.984-33.907-33.984   c-18.769,0-33.669,15.215-33.669,33.984c0,16.226,11.902,29.788,26.902,33.165v100.657c-15,1.71-27.457,9.161-36.068,20.02   l-42.147-33.265c0.812-1.891,1.192-3.973,1.192-6.159c0-8.647-7.044-15.657-15.692-15.657c-8.646,0-15.673,7.01-15.673,15.657   s7.001,15.656,15.649,15.656c3.094,0,5.968-0.91,8.399-2.46l42.871,33.95c-4.146,7.628-6.508,16.371-6.508,25.665   c0,4.772,0.628,9.397,1.795,13.803L99.943,314.091c-4.106-6.382-11.266-10.611-19.42-10.611c-12.751,0-23.086,10.336-23.086,23.087   s10.335,23.086,23.086,23.086c12.047,0,21.932-9.224,22.988-20.993l111.074-43.937c4.993,8.376,12.191,15.282,20.801,19.909   l-15.088,41.525c-0.52-0.053-1.049-0.08-1.581-0.08c-8.647,0-15.658,7.011-15.658,15.656c0,8.646,7.011,15.657,15.658,15.657   c8.649,0,15.655-7.011,15.655-15.657c0-4.797-2.163-9.086-5.561-11.958l15.076-41.493c5.325,1.767,11.013,2.736,16.931,2.736   c4.366,0,8.604-0.533,12.669-1.514l35.744,95.202c-9.619,6.003-16.024,16.675-16.024,28.847c0,18.771,15.215,33.984,33.983,33.984   c18.771,0,33.984-15.214,33.984-33.984c0-18.768-15.214-33.982-33.984-33.982c-1.328,0-2.639,0.084-3.928,0.232l-35.955-95.766   c7.887-4.472,14.533-10.872,19.293-18.567l117.451,44.365c0.639,5.577,5.368,9.911,11.117,9.911c6.187,0,11.2-5.016,11.2-11.199   C446.37,322.362,441.356,317.35,435.17,317.35z">
                  </path>
                </g>
              </g>
              <g id="SvgjsG2557" featurekey="nameFeature-0"
                transform="matrix(0.8006012370607496,0,0,0.8006012370607496,96.62456674489209,22.883851416406728)"
                fill="url(#SvgjsLinearGradient2563)">
                <path
                  d="M15.859 40.39063 c-8.1445 0 -14.141 -5.625 -14.141 -14.434 c0 -8.9258 6.1328 -14.57 14.434 -14.57 c5.4492 0 9.9609 2.4023 12.422 6.6406 l-5.1367 2.7344 c-1.4844 -2.8906 -4.1406 -4.2773 -7.2852 -4.2773 c-4.8828 0 -8.5547 3.3594 -8.5547 9.3359 c0 5.7617 3.4375 9.4727 8.7695 9.4727 c3.6133 0 6.9336 -1.7969 7.7344 -5.918 l-7.7148 0 l0 -4.707 l13.262 0 l0 15.332 l-4.6094 0 l0 -3.9063 c-1.8164 2.6758 -4.8633 4.2969 -9.1797 4.2969 z M51.5872265625 40 l-7.3438 -12.422 l-1.6992 0 l0 12.422 l-5.8594 0 l0 -28.223 l10.234 0 c6.3867 0 9.082 3.7695 9.082 8.4375 c0 3.7891 -2.1484 6.25 -5.9766 7.0703 l8.4961 12.715 l-6.9336 0 z M42.5439265625 16.641 l0 6.7383 l3.457 0 c3.125 0 4.3945 -1.3281 4.3945 -3.3594 c0 -2.0117 -1.2695 -3.3789 -4.3945 -3.3789 l-3.457 0 z M63.779253125 40 l0 -28.223 l5.8594 0 l0 28.223 l-5.8594 0 z M94.2533984375 16.934 l-10.469 0 l0 6.4063 l9.2773 0 l0 5.0977 l-9.2773 0 l0 6.3867 l10.469 0 l0 5.1758 l-16.367 0 l0 -28.223 l16.367 0 l0 5.1563 z M119.19965625 11.777000000000001 l6.2305 0 l-10.43 28.223 l-6.4453 0 l-10.371 -28.223 l6.2109 0 l7.4023 21.387 z M149.5165390625 40 l-2.0508 -5.8203 l-11.855 0 l-2.0508 5.8203 l-5.9961 0 l10.391 -28.223 l7.168 0 l10.391 28.223 l-5.9961 0 z M137.3295390625 29.277 l8.418 0 l-4.1992 -11.973 z M179.990546875 11.777000000000001 l5.8398 0 l0 28.223 l-6.7773 0 l-12.5 -20.176 l0 20.176 l-5.8398 0 l0 -28.223 l6.6992 0 l12.578 20.059 l0 -20.059 z M206.5963359375 40.39063 c-8.3008 0 -14.434 -5.6445 -14.434 -14.512 s6.1328 -14.492 14.434 -14.492 c6.2891 0 11.328 3.2227 13.34 8.5742 l-5.4688 1.9922 c-1.25 -3.2813 -4.2383 -5.1758 -7.8711 -5.1758 c-4.8633 0 -8.5938 3.3984 -8.5938 9.1016 s3.7305 9.1211 8.5938 9.1211 c3.6328 0 6.6211 -1.9141 7.8711 -5.1953 l5.4688 1.9922 c-2.0117 5.3516 -7.0508 8.5938 -13.34 8.5938 z M242.07078125 16.934 l-10.469 0 l0 6.4063 l9.2773 0 l0 5.0977 l-9.2773 0 l0 6.3867 l10.469 0 l0 5.1758 l-16.367 0 l0 -28.223 l16.367 0 l0 5.1563 z M272.158578125 11.777000000000001 c5.5273 0 8.9648 4.1016 8.9648 9.1211 c0 5.1367 -3.4375 8.9844 -8.9648 8.9844 l-5.8789 0 l0 10.117 l-5.8594 0 l0 -28.223 l11.738 0 z M271.181578125 24.98 c2.9297 0 4.2969 -1.6211 4.2969 -4.1602 c0 -2.4414 -1.3672 -4.1406 -4.2969 -4.1406 l-4.9023 0 l0 8.3008 l4.9023 0 z M301.9094921875 40 l-7.3438 -12.422 l-1.6992 0 l0 12.422 l-5.8594 0 l0 -28.223 l10.234 0 c6.3867 0 9.082 3.7695 9.082 8.4375 c0 3.7891 -2.1484 6.25 -5.9766 7.0703 l8.4961 12.715 l-6.9336 0 z M292.8661921875 16.641 l0 6.7383 l3.457 0 c3.125 0 4.3945 -1.3281 4.3945 -3.3594 c0 -2.0117 -1.2695 -3.3789 -4.3945 -3.3789 l-3.457 0 z M326.60121875 40.39063 c-8.3008 0 -14.434 -5.6641 -14.434 -14.512 c0 -8.8672 6.1328 -14.492 14.434 -14.492 c8.2813 0 14.414 5.625 14.414 14.492 c0 8.8477 -6.1328 14.512 -14.414 14.512 z M326.60121875 35.0195 c4.8633 0 8.5938 -3.418 8.5938 -9.1406 c0 -5.7031 -3.7305 -9.1016 -8.5938 -9.1016 s-8.5938 3.3984 -8.5938 9.1016 c0 5.7227 3.7305 9.1406 8.5938 9.1406 z">
                </path>
              </g>
            </svg>
          </div>
          <!-- Remove the text spans if using the full SVG with text -->
          <!-- <span class="text-xs text-blue-300 hidden sm:block ml-2">Enterprise Edition</span> -->
        </div>

        <!-- Primary Navigation - Desktop -->
        <nav class="hidden md:ml-8 md:flex md:space-x-2">
          <ng-container *ngIf="role === 'admin'; else userNav">
            <a [routerLink]="['/', role, 'complaints']" routerLinkActive="nav-link-active"
              class="text-gray-200 px-3 py-2 hover:text-white hover:bg-slate-600 rounded-md transition-all duration-200 flex items-center nav-link">
              <i class="fas fa-ticket-alt mr-2"></i> Complaints
            </a>
            <a [routerLink]="['/', role, 'suggestions']" routerLinkActive="nav-link-active"
              class="text-gray-200 px-3 py-2 hover:text-white hover:bg-slate-600 rounded-md transition-all duration-200 flex items-center nav-link">
              <i class="fas fa-lightbulb mr-2"></i> Suggestions
            </a>
            <a [routerLink]="['/', role, 'dashboard']" routerLinkActive="nav-link-active"
              class="text-gray-200 px-3 py-2 hover:text-white hover:bg-slate-600 rounded-md transition-all duration-200 flex items-center nav-link">
              <i class="fas fa-chart-bar mr-2"></i> Analytics
            </a>
            <!-- Admin-only section -->
            <!-- <a [routerLink]="['/', role, 'users']" routerLinkActive="nav-link-active"
              class="text-gray-200 px-3 py-2 hover:text-white hover:bg-slate-600 rounded-md transition-all duration-200 flex items-center nav-link">
              <i class="fas fa-users mr-2"></i> Users
            </a> -->
          </ng-container>

          <ng-template #userNav>
            <a [routerLink]="['/', role, 'complaints']" routerLinkActive="nav-link-active"
              class="text-gray-200 px-3 py-2 hover:text-white hover:bg-slate-600 rounded-md transition-all duration-200 flex items-center nav-link">
              <i class="fas fa-clipboard-list mr-2"></i> Complaints
            </a>
            <a [routerLink]="['/', role, 'suggestions']" routerLinkActive="nav-link-active"
              class="text-gray-200 px-3 py-2 hover:text-white hover:bg-slate-600 rounded-md transition-all duration-200 flex items-center nav-link">
              <i class="fas fa-lightbulb mr-2"></i> Suggestions
            </a>
            <a [routerLink]="['/', role, 'dashboard']" routerLinkActive="nav-link-active"
              class="text-gray-200 px-3 py-2 hover:text-white hover:bg-slate-600 rounded-md transition-all duration-200 flex items-center nav-link">
              <i class="fas fa-chart-line mr-2"></i> Analytics
            </a>
          </ng-template>
        </nav>
      </div>

      <!-- Right Side - Organization, Role Badge & User Functions -->
      <div class="flex items-center space-x-3">
        <!-- Organization Badge -->
        <div
          class="hidden md:flex items-center py-1.5 px-3 rounded-lg bg-slate-600/50 border border-slate-500 shadow-inner">
          <i class="fas fa-building mr-2 text-blue-300"></i>
          <span class="text-white font-medium text-sm">{{ organizationName || 'Micropro' }}</span>
        </div>

        <!-- Role Badge - Visually clear role indicator -->
        <div class="hidden md:flex items-center py-1 px-2.5 rounded-md shadow-sm" [ngClass]="{
            'bg-purple-700/60 text-purple-100 border border-purple-500': role === 'admin',
            'bg-blue-700/60 text-blue-100 border border-blue-500': role === 'hod',
            'bg-green-700/60 text-green-100 border border-green-500': role === 'employee',
            'bg-yellow-700/60 text-yellow-100 border border-yellow-500': role === 'client'
          }">
          <i class="mr-1.5 text-xs" [ngClass]="{
              'fas fa-user-shield': role === 'admin',
              'fas fa-user-tie': role === 'hod',
              'fas fa-user': role === 'employee',
              'fas fa-user-alt': role === 'client'
            }"></i>
          <span class="text-xs font-medium">{{ formatRoleDisplay(role) }}</span>
        </div>

        <!-- Notification Bell with Badge -->
        <!-- <button class="relative p-1.5 text-white hover:bg-slate-600 rounded-full transition-colors">
          <i class="fas fa-bell"></i>
          <div *ngIf="notificationCount > 0"
            class="absolute top-0 right-0 flex items-center justify-center h-4 w-4 bg-red-500 text-white text-xs rounded-full transform translate-x-1 -translate-y-1 animate-pulse">
            {{ notificationCount > 9 ? '9+' : notificationCount }}
          </div>
        </button> -->


        <!-- Add this to your navbar component where the bell icon currently is -->
        <!-- Notification Bell with Badge and Dropdown -->
        <!-- Notification Bell with Badge and Dropdown -->
        <div class="relative dropdown-container">
          <button (click)="toggleNotificationsDropdown()"
            class="relative p-1.5 text-white hover:bg-slate-600 rounded-full transition-colors">
            <i class="fas fa-bell"></i>
            <div *ngIf="notificationCount > 0"
              class="absolute top-0 right-0 flex items-center justify-center h-4 w-4 bg-red-500 text-white text-xs rounded-full transform translate-x-1 -translate-y-1 animate-pulse">
              {{ notificationCount > 9 ? '9+' : notificationCount }}
            </div>
          </button>

          <!-- Notifications Dropdown Panel -->
          <div *ngIf="showNotificationsDropdown"
            class="absolute right-0 mt-3 w-96 max-h-[80vh] rounded-xl border border-gray-200 bg-white shadow-2xl ring-1 ring-black ring-opacity-5 z-50 notification-dropdown overflow-hidden">
            <!-- Header -->
            <!-- Replace the existing header in your notification dropdown -->
            <!-- Header - More compact and professional -->
            <!-- Header - More compact and professional with improved layout -->
            <!-- Header - More compact and professional with improved layout -->
            <!-- Add this inside your notification dropdown -->
            <div *ngIf="!isConnected" class="px-4 py-2 bg-yellow-50 border-b border-yellow-100 flex items-center">
              <div class="h-4 w-4 rounded-full bg-yellow-200 animate-pulse mr-2"></div>
              <span class="text-xs text-yellow-800">Reconnecting to notification service...</span>
            </div>

            <div class="px-4 py-3 border-b border-gray-200 sticky top-0 bg-white z-10 shadow-sm">
              <!-- Top row with title and buttons -->
              <div class="flex items-center justify-between">
                <div class="flex items-center">
                  <div class="h-7 w-7 rounded-full bg-blue-100 text-blue-600 flex items-center justify-center mr-2.5">
                    <i class="fas fa-bell text-sm"></i>
                  </div>
                  <h3 class="font-medium text-gray-800 text-base leading-tight">Notifications</h3>
                </div>
                <div class="flex items-center space-x-1">
                  <button *ngIf="notifications && notifications.length > 0" (click)="markAllAsRead()"
                    class="text-xs font-medium text-blue-700 hover:text-blue-800 bg-blue-50 hover:bg-blue-100 px-2 py-1 rounded-md transition-colors duration-200 flex items-center">
                    <i class="fas fa-check-circle mr-1"></i>
                    Mark read
                  </button>
                  <button *ngIf="notifications && notifications.length > 0" (click)="clearAllNotifications()"
                    class="text-xs font-medium text-gray-600 hover:text-gray-800 bg-gray-100 hover:bg-gray-200 px-2 py-1 rounded-md transition-colors duration-200 flex items-center ml-1">
                    <i class="fas fa-trash-alt mr-1"></i>
                    Clear
                  </button>
                </div>
              </div>
              <!-- Tagline below the title -->
              <p class="text-xs text-gray-500 mt-1 ml-9.5">Stay updated with system alerts</p>
            </div>

            <!-- Tabs -->
            <div class="border-b border-gray-100 bg-gray-50">
              <div class="flex">
                <button (click)="setActiveTab('all')"
                  [ngClass]="{'text-blue-600 border-blue-600': activeNotificationTab === 'all', 'text-gray-500 border-transparent hover:text-gray-700': activeNotificationTab !== 'all'}"
                  class="flex-1 py-3 px-4 text-sm font-medium border-b-2 transition-all duration-200 focus:outline-none">
                  All
                  <span *ngIf="notificationCount > 0"
                    class="ml-1.5 bg-blue-100 text-blue-800 text-xs font-medium px-2 py-0.5 rounded-full">
                    {{ notificationCount }}
                  </span>
                </button>
                <button (click)="setActiveTab('unread')"
                  [ngClass]="{'text-blue-600 border-blue-600': activeNotificationTab === 'unread', 'text-gray-500 border-transparent hover:text-gray-700': activeNotificationTab !== 'unread'}"
                  class="flex-1 py-3 px-4 text-sm font-medium border-b-2 transition-all duration-200 focus:outline-none">
                  Unread
                  <span *ngIf="getUnreadCount() > 0"
                    class="ml-1.5 bg-blue-100 text-blue-800 text-xs font-medium px-2 py-0.5 rounded-full">
                    {{ getUnreadCount() }}
                  </span>
                </button>
                <button (click)="setActiveTab('important')"
                  [ngClass]="{'text-blue-600 border-blue-600': activeNotificationTab === 'important', 'text-gray-500 border-transparent hover:text-gray-700': activeNotificationTab !== 'important'}"
                  class="flex-1 py-3 px-4 text-sm font-medium border-b-2 transition-all duration-200 focus:outline-none">
                  Important
                  <span *ngIf="getImportantCount() > 0"
                    class="ml-1.5 bg-red-100 text-red-800 text-xs font-medium px-2 py-0.5 rounded-full">
                    {{ getImportantCount() }}
                  </span>
                </button>
              </div>
            </div>

            <!-- Notifications List -->
            <div class="overflow-y-auto custom-scrollbar" style="max-height: 450px;">
              <div *ngIf="getFilteredNotifications().length > 0; else noNotifications" class="divide-y divide-gray-100">
                <div *ngFor="let notification of getFilteredNotifications()"
                  [ngClass]="{'bg-blue-50/70': !notification.read}"
                  class="px-5 py-4 hover:bg-gray-50 transition-colors duration-200 cursor-pointer group"
                  (click)="handleNotificationClick(notification)">
                  <div class="flex items-start">
                    <!-- Notification icon based on type -->
                    <div class="flex-shrink-0 mr-4">
                      <div
                        class="h-10 w-10 rounded-lg flex items-center justify-center shadow-sm transition-all group-hover:shadow group-hover:scale-105"
                        [ngClass]="{
                     'bg-gradient-to-br from-red-50 to-red-100 text-red-600': notification.type === 'urgent',
                     'bg-gradient-to-br from-blue-50 to-blue-100 text-blue-600': notification.type === 'assignment',
                     'bg-gradient-to-br from-green-50 to-green-100 text-green-600': notification.type === 'status',
                     'bg-gradient-to-br from-purple-50 to-purple-100 text-purple-600': notification.type === 'system',
                     'bg-gradient-to-br from-amber-50 to-amber-100 text-amber-600': notification.type === 'comment'
                   }">
                        <i class="fas transition-all" [ngClass]="{
                     'fa-exclamation-circle': notification.type === 'urgent',
                     'fa-tasks': notification.type === 'assignment',
                     'fa-check-circle': notification.type === 'status',
                     'fa-cog': notification.type === 'system',
                     'fa-comment-alt': notification.type === 'comment'
                   }">
                        </i>
                      </div>
                    </div>

                    <!-- Notification content -->
                    <div class="flex-1 min-w-0">
                      <div class="flex items-center justify-between">
                        <p
                          class="text-sm font-medium text-gray-900 group-hover:text-blue-700 transition-colors flex items-center">
                          {{ notification.title }}
                          <!-- Unread indicator -->
                          <span *ngIf="!notification.read"
                            class="ml-2 inline-block h-2 w-2 rounded-full bg-blue-500 animate-pulse-subtle"></span>
                        </p>
                        <div class="flex items-center space-x-1">
                          <button *ngIf="!notification.read" (click)="markAsRead(notification, $event)"
                            class="text-blue-600 hover:text-blue-800 p-1 rounded-full hover:bg-blue-50 transition-colors opacity-0 group-hover:opacity-100">
                            <i class="fas fa-check text-xs"></i>
                          </button>
                          <span class="text-xs text-gray-500 ml-auto whitespace-nowrap">{{
                            formatTimeAgo(notification.timestamp)
                            }}</span>
                        </div>
                      </div>
                      <p class="text-sm text-gray-600 line-clamp-2 mt-1 group-hover:text-gray-900 transition-colors">{{
                        notification.message }}</p>

                      <!-- Bottom row with additional details -->
                      <div class="mt-2 flex items-center justify-between">
                        <!-- Related task/ticket number if available -->
                        <div class="flex">
                          <span *ngIf="notification.ticketId"
                            class="flex items-center text-xs font-medium rounded-md px-2 py-1 bg-gray-100 text-gray-700 group-hover:bg-blue-100 group-hover:text-blue-800 transition-colors">
                            <i class="fas fa-ticket-alt mr-1"></i>
                            #{{ notification.ticketId }}
                          </span>
                          <!-- Priority tag for urgent notifications -->
                          <span *ngIf="notification.type === 'urgent'"
                            class="ml-2 flex items-center text-xs font-medium rounded-md px-2 py-1 bg-red-100 text-red-800">
                            <i class="fas fa-flag mr-1"></i>
                            High Priority
                          </span>
                        </div>

                        <!-- Action button -->
                        <button
                          class="text-xs text-blue-700 hover:text-blue-900 font-medium transition-colors hover:underline">
                          View Details
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- No notifications placeholder -->
              <ng-template #noNotifications>
                <div class="py-12 px-4 text-center">
                  <div
                    class="mx-auto h-20 w-20 rounded-full bg-gray-100 flex items-center justify-center mb-4 animate-pulse-slow">
                    <i class="fas fa-bell-slash text-gray-400 text-2xl"></i>
                  </div>
                  <h3 class="text-gray-700 text-lg font-medium mb-2">No notifications</h3>
                  <p class="text-gray-500 mb-4 max-w-xs mx-auto">You're all caught up! We'll notify you when there's
                    something
                    new.</p>
                  <button
                    class="text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded-lg transition-colors shadow-sm">
                    Refresh
                  </button>
                </div>
              </ng-template>
            </div>

            <!-- Footer with view all link -->
            <div class="px-5 py-3.5 text-center border-t border-gray-200 bg-gray-50 sticky bottom-0 shadow-inner">
              <a [routerLink]="['/', role, 'notifications']" (click)="toggleNotificationsDropdown()"
                class="inline-flex items-center justify-center text-sm text-blue-700 hover:text-blue-800 font-medium hover:underline transition-colors">
                View all notifications
                <i class="fas fa-chevron-right ml-1.5 text-xs"></i>
              </a>
            </div>
          </div>
        </div>
        <!-- Create New Button -->
        <div class="relative dropdown-container">
          <button (click)="toggleNewDropdown()"
            class="flex items-center rounded-lg bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 px-3 py-1.5 text-white transition-all duration-200 shadow-sm hover:shadow-md dropdown-toggle btn-pulse">
            <i class="fas fa-plus mr-1.5"></i>
            <span class="hidden sm:inline text-sm font-medium">Create</span>
            <i class="fas fa-chevron-down ml-1.5 text-xs"></i>
          </button>

          <!-- Create Dropdown Menu -->
          <div *ngIf="showNewDropdown"
            class="absolute right-0 mt-2 w-60 rounded-lg border border-slate-200 bg-white py-1 shadow-xl ring-1 ring-black ring-opacity-5 z-50 dropdown-menu">
            <div class="px-4 py-2 text-xs text-slate-500 border-b flex items-center">
              <i class="fas fa-plus-circle mr-1.5 text-blue-500"></i>
              <span>Create New</span>
            </div>

            <!-- Admin options -->
            <ng-container *ngIf="role === 'admin' || role === 'hod'">
              <a routerLink="/admin/users/create" (click)="toggleNewDropdown()"
                class="block px-4 py-2.5 text-sm text-slate-700 hover:bg-blue-50 hover:text-blue-700 transition-colors dropdown-item flex items-center">
                <div class="w-8 h-8 mr-3 flex items-center justify-center rounded-full bg-indigo-100 text-indigo-600">
                  <i class="fas fa-user-plus"></i>
                </div>
                <div>
                  <div class="font-medium">New User</div>
                  <div class="text-xs text-slate-500">Add user to the system</div>
                </div>
              </a>
              <a routerLink="/admin/department" (click)="toggleNewDropdown()"
                class="block px-4 py-2.5 text-sm text-slate-700 hover:bg-blue-50 hover:text-blue-700 transition-colors dropdown-item flex items-center">
                <div class="w-8 h-8 mr-3 flex items-center justify-center rounded-full bg-blue-100 text-blue-600">
                  <i class="fas fa-building"></i>
                </div>
                <div>
                  <div class="font-medium">New Department</div>
                  <div class="text-xs text-slate-500">Create a department</div>
                </div>
              </a>

              <!-- Add these links right after the Department option in the Create Dropdown Menu -->
              <a [routerLink]="['/', role, 'categories']" (click)="toggleNewDropdown()"
                class="block px-4 py-2.5 text-sm text-slate-700 hover:bg-blue-50 hover:text-blue-700 transition-colors dropdown-item flex items-center">
                <div class="w-8 h-8 mr-3 flex items-center justify-center rounded-full bg-purple-100 text-purple-600">
                  <i class="fas fa-tag"></i>
                </div>
                <div>
                  <div class="font-medium">New Category</div>
                  <div class="text-xs text-slate-500">Create complaint category</div>
                </div>
              </a>
              <a [routerLink]="['/', role, 'tags']" (click)="toggleNewDropdown()"
                class="block px-4 py-2.5 text-sm text-slate-700 hover:bg-blue-50 hover:text-blue-700 transition-colors dropdown-item flex items-center">
                <div class="w-8 h-8 mr-3 flex items-center justify-center rounded-full bg-green-100 text-green-600">
                  <i class="fas fa-tags"></i>
                </div>
                <div>
                  <div class="font-medium">New Tags</div>
                  <div class="text-xs text-slate-500">Create complaint tags</div>
                </div>
              </a>
            </ng-container>

            <!-- Common options for all users -->
            <a [routerLink]="['/', role, 'create-complaints']" (click)="toggleNewDropdown()"
              class="block px-4 py-2.5 text-sm text-slate-700 hover:bg-blue-50 hover:text-blue-700 transition-colors dropdown-item flex items-center">
              <div class="w-8 h-8 mr-3 flex items-center justify-center rounded-full bg-blue-100 text-blue-600">
                <i class="fas fa-clipboard-list"></i>
              </div>
              <div>
                <div class="font-medium">New Complaint</div>
                <div class="text-xs text-slate-500">Register a complaint</div>
              </div>
            </a>
            <a [routerLink]="['/', role, 'create-suggestion']" (click)="toggleNewDropdown()"
              class="block px-4 py-2.5 text-sm text-slate-700 hover:bg-blue-50 hover:text-blue-700 transition-colors dropdown-item flex items-center">
              <div class="w-8 h-8 mr-3 flex items-center justify-center rounded-full bg-amber-100 text-amber-600">
                <i class="fas fa-lightbulb"></i>
              </div>
              <div>
                <div class="font-medium">New Suggestion</div>
                <div class="text-xs text-slate-500">Submit an improvement idea</div>
              </div>
            </a>
          </div>
        </div>

        <!-- User Menu -->
        <div class="relative ml-2 user-menu-container">
          <button type="button" (click)="toggleUserMenu()"
            class="flex items-center space-x-2 text-sm bg-slate-700 hover:bg-slate-600 rounded-lg p-1.5 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-white focus:ring-offset-2 focus:ring-offset-slate-800 dropdown-toggle user-avatar">
            <div
              class="flex h-7 w-7 items-center justify-center rounded-full bg-gradient-to-br from-indigo-500 to-purple-600 text-white font-medium uppercase shadow-inner">
              {{ userInitials }}
            </div>
            <!-- Show username and chevron on larger screens -->
            <div class="hidden lg:flex items-center space-x-1">
              <span class="text-white text-sm font-medium max-w-[100px] truncate">{{ username }}</span>
              <i class="fas fa-chevron-down text-xs text-slate-300"></i>
            </div>
          </button>

          <!-- User Dropdown -->
          <div *ngIf="showUserMenu"
            class="absolute right-0 mt-2 w-64 origin-top-right rounded-lg bg-white py-1 shadow-xl ring-1 ring-black ring-opacity-5 z-50 dropdown-menu">
            <div class="p-4 text-sm border-b">
              <div class="flex items-center">
                <div
                  class="h-10 w-10 rounded-full bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center text-white font-medium uppercase">
                  {{ userInitials }}
                </div>
                <div class="ml-3">
                  <div class="font-medium text-slate-900">{{ username || 'User' }}</div>
                  <div class="text-xs text-slate-500 flex items-center">
                    <i class="fas fa-envelope mr-1"></i>
                    <span class="truncate">{{ userEmail || 'user@example.com' }}</span>
                  </div>
                </div>
              </div>

              <!-- User role badge in dropdown -->
              <div class="mt-3 flex">
                <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium shadow-sm"
                  [ngClass]="{
                    'bg-purple-100 text-purple-800': role === 'admin',
                    'bg-blue-100 text-blue-800': role === 'hod',
                    'bg-green-100 text-green-800': role === 'employee',
                    'bg-yellow-100 text-yellow-800': role === 'client'
                  }">
                  <i class="mr-1.5 fa-sm" [ngClass]="{
                      'fas fa-user-shield': role === 'admin',
                      'fas fa-user-tie': role === 'hod',
                      'fas fa-user': role === 'employee',
                      'fas fa-user-alt': role === 'client'
                    }"></i>
                  {{ formatRoleDisplay(role) }}
                </span>

                <!-- Organization badge in dropdown -->
                <span
                  class="ml-2 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-slate-100 text-slate-800 shadow-sm">
                  <i class="fas fa-building mr-1.5 fa-sm"></i>
                  {{ organizationName || 'Micropro' }}
                </span>
              </div>
            </div>

            <div class="py-1">
              <a [routerLink]="['/', role, 'profile-info']" (click)="toggleUserMenu()"
                class="block px-4 py-2.5 text-sm text-slate-700 hover:bg-blue-50 hover:text-blue-700 dropdown-item flex items-center">
                <i class="fas fa-user-circle w-5 mr-2 text-blue-500"></i> My Profile
              </a>
              <a routerLink="/settings" (click)="toggleUserMenu()"
                class="block px-4 py-2.5 text-sm text-slate-700 hover:bg-blue-50 hover:text-blue-700 dropdown-item flex items-center">
                <i class="fas fa-cog w-5 mr-2 text-slate-500"></i> Settings
              </a>
              <a routerLink="/help" (click)="toggleUserMenu()"
                class="block px-4 py-2.5 text-sm text-slate-700 hover:bg-blue-50 hover:text-blue-700 dropdown-item flex items-center">
                <i class="fas fa-question-circle w-5 mr-2 text-green-500"></i> Help & Support
              </a>
            </div>

            <div class="py-1 border-t">
              <button (click)="logout()"
                class="block w-full text-left px-4 py-2.5 text-sm text-red-600 hover:bg-red-50 dropdown-item flex items-center">
                <i class="fas fa-sign-out-alt w-5 mr-2"></i> Sign out
              </button>
            </div>
          </div>
        </div>

        <!-- Add this next to your user profile button in the navbar -->


        <!-- Mobile menu button -->
        <button type="button" (click)="toggleMobileMenu()"
          class="md:hidden inline-flex items-center justify-center p-2 rounded-md text-gray-200 hover:text-white hover:bg-slate-600 focus:outline-none focus:ring-2 focus:ring-white transition-colors">
          <i *ngIf="!showMobileMenu" class="fas fa-bars block h-6 w-6"></i>
          <i *ngIf="showMobileMenu" class="fas fa-times block h-6 w-6"></i>
        </button>
      </div>
    </div>
  </div>

  <!-- Mobile menu -->
  <div *ngIf="showMobileMenu" class="md:hidden mobile-menu">
    <div class="px-2 pt-2 pb-3 space-y-1 sm:px-3 bg-slate-700">
      <!-- Mobile role badge -->
      <div class="mb-3 flex items-center justify-between px-3 py-2 rounded-md" [ngClass]="{
          'bg-purple-800/60 text-white border border-purple-600': role === 'admin',
          'bg-blue-800/60 text-white border border-blue-600': role === 'hod',
          'bg-green-800/60 text-white border border-green-600': role === 'employee',
          'bg-yellow-800/60 text-white border border-yellow-600': role === 'client'
        }">
        <div class="flex items-center">
          <i class="mr-2 text-sm" [ngClass]="{
              'fas fa-user-shield': role === 'admin',
              'fas fa-user-tie': role === 'hod',
              'fas fa-user': role === 'employee',
              'fas fa-user-alt': role === 'client'
            }"></i>
          <span class="font-medium">{{ formatRoleDisplay(role) }}</span>
        </div>
        <!-- Organization display on mobile -->
        <div class="text-sm opacity-80">
          <i class="fas fa-building mr-1"></i> {{ organizationName || 'Micropro' }}
        </div>
      </div>

      <!-- Mobile navigation -->
      <ng-container *ngIf="role === 'admin'; else mobileUserNav">
        <a [routerLink]="['/', role, 'complaints']" routerLinkActive="bg-slate-600 text-white"
          class="block px-3 py-2.5 rounded-md text-base font-medium text-gray-200 hover:bg-slate-600 hover:text-white mobile-nav-item">
          <i class="fas fa-ticket-alt mr-2.5 w-5 text-center text-blue-400"></i> Complaints
        </a>
        <a [routerLink]="['/', role, 'suggestions']" routerLinkActive="bg-slate-600 text-white"
          class="block px-3 py-2.5 rounded-md text-base font-medium text-gray-200 hover:bg-slate-600 hover:text-white mobile-nav-item">
          <i class="fas fa-lightbulb mr-2.5 w-5 text-center text-amber-400"></i> Suggestions
        </a>
        <a [routerLink]="['/', role, 'dashboard']" routerLinkActive="bg-slate-600 text-white"
          class="block px-3 py-2.5 rounded-md text-base font-medium text-gray-200 hover:bg-slate-600 hover:text-white mobile-nav-item">
          <i class="fas fa-chart-bar mr-2.5 w-5 text-center text-green-400"></i> Analytics
        </a>
        <a [routerLink]="['/', role, 'users']" routerLinkActive="bg-slate-600 text-white"
          class="block px-3 py-2.5 rounded-md text-base font-medium text-gray-200 hover:bg-slate-600 hover:text-white mobile-nav-item">
          <i class="fas fa-users mr-2.5 w-5 text-center text-purple-400"></i> Users
        </a>
      </ng-container>

      <ng-template #mobileUserNav>
        <a [routerLink]="['/', role, 'complaints']" routerLinkActive="bg-slate-600 text-white"
          class="block px-3 py-2.5 rounded-md text-base font-medium text-gray-200 hover:bg-slate-600 hover:text-white mobile-nav-item">
          <i class="fas fa-clipboard-list mr-2.5 w-5 text-center text-blue-400"></i> Complaints
        </a>
        <a [routerLink]="['/', role, 'suggestions']" routerLinkActive="bg-slate-600 text-white"
          class="block px-3 py-2.5 rounded-md text-base font-medium text-gray-200 hover:bg-slate-600 hover:text-white mobile-nav-item">
          <i class="fas fa-lightbulb mr-2.5 w-5 text-center text-amber-400"></i> Suggestions
        </a>
        <a [routerLink]="['/', role, 'dashboard']" routerLinkActive="bg-slate-600 text-white"
          class="block px-3 py-2.5 rounded-md text-base font-medium text-gray-200 hover:bg-slate-600 hover:text-white mobile-nav-item">
          <i class="fas fa-chart-line mr-2.5 w-5 text-center text-green-400"></i> Analytics
        </a>
      </ng-template>

      <!-- Quick actions section -->
      <div class="pt-3 border-t border-slate-600">
        <div class="px-3 py-1 text-xs font-medium text-slate-400">QUICK ACTIONS</div>
        <a [routerLink]="['/', role, 'create-complaints']"
          class="block px-3 py-2.5 rounded-md text-base font-medium text-gray-200 hover:bg-blue-700 hover:text-white mobile-nav-item bg-blue-800/40">
          <i class="fas fa-plus-circle mr-2.5 w-5 text-center text-blue-400"></i> New Complaint
        </a>
        <a [routerLink]="['/', role, 'create-suggestion']"
          class="block px-3 py-2.5 rounded-md text-base font-medium text-gray-200 hover:bg-amber-700 hover:text-white mobile-nav-item bg-amber-800/40">
          <i class="fas fa-lightbulb mr-2.5 w-5 text-center text-amber-400"></i> New Suggestion
        </a>
      </div>

      <!-- Mobile Profile Section -->
      <div class="border-t border-slate-600 pt-4 pb-3">
        <div class="flex items-center px-3 py-2 bg-slate-800/50 rounded-lg shadow-inner">
          <div class="flex-shrink-0">
            <div
              class="h-10 w-10 rounded-full bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center text-white shadow-md">
              {{ userInitials }}
            </div>
          </div>
          <div class="ml-3">
            <div class="text-base font-medium text-white">{{ username }}</div>
            <div class="text-sm text-slate-300 flex items-center">
              <i class="fas fa-envelope mr-1 text-xs"></i>
              <span class="truncate max-w-[180px]">{{ userEmail || 'user@example.com' }}</span>
            </div>
          </div>
        </div>
        <div class="mt-3 px-2 space-y-1">
          <a routerLink="/profile"
            class="block px-3 py-2.5 rounded-md text-base font-medium text-gray-200 hover:bg-slate-600 hover:text-white mobile-nav-item">
            <i class="fas fa-user-circle mr-2.5 w-5 text-center text-blue-400"></i> Profile
          </a>
          <a routerLink="/settings"
            class="block px-3 py-2.5 rounded-md text-base font-medium text-gray-200 hover:bg-slate-600 hover:text-white mobile-nav-item">
            <i class="fas fa-cog mr-2.5 w-5 text-center text-slate-400"></i> Settings
          </a>
          <a routerLink="/help"
            class="block px-3 py-2.5 rounded-md text-base font-medium text-gray-200 hover:bg-slate-600 hover:text-white mobile-nav-item">
            <i class="fas fa-question-circle mr-2.5 w-5 text-center text-green-400"></i> Help & Support
          </a>
          <button (click)="logout()"
            class="w-full text-left px-3 py-2.5 rounded-md text-base font-medium text-red-300 hover:bg-red-900 hover:text-white mobile-nav-item">
            <i class="fas fa-sign-out-alt mr-2.5 w-5 text-center"></i> Sign out
          </button>
        </div>
      </div>
    </div>
  </div>
</header>