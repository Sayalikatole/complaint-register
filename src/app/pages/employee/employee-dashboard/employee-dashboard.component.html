<div class="bg-gray-50 min-h-screen pb-8">
    <!-- Tab Navigation -->
    <div class="px-4 sm:px-6 lg:px-8 mb-6">
        <div class="border-b border-gray-200">
            <nav class="-mb-px flex space-x-8">
                <button class="py-4 px-1 border-b-2 font-medium text-sm" [ngClass]="{
                'border-indigo-500 text-indigo-600': activeTab === 'assigned',
                'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300': activeTab !== 'assigned'
              }" (click)="switchTab('assigned')">
                    <i class="fas fa-tasks mr-2"></i>
                    Assigned to Me
                </button>
                <button class="py-4 px-1 border-b-2 font-medium text-sm" [ngClass]="{
                'border-indigo-500 text-indigo-600': activeTab === 'created',
                'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300': activeTab !== 'created'
              }" (click)="switchTab('created')">
                    <i class="fas fa-clipboard-list mr-2"></i>
                    Created by Me
                </button>
            </nav>
        </div>
    </div>

    <!-- Loading State -->
    <div *ngIf="isLoading" class="px-4 sm:px-6 lg:px-8 py-10">
        <div class="flex justify-center">
            <div class="animate-spin rounded-full h-10 w-10 border-b-2 border-indigo-500"></div>
        </div>
        <p class="text-center text-gray-500 mt-4">Loading dashboard data...</p>
    </div>

    <!-- Error Message -->
    <div *ngIf="errorMessage && !isLoading" class="px-4 sm:px-6 lg:px-8 py-4">
        <div class="bg-red-50 border-l-4 border-red-400 p-4">
            <div class="flex">
                <div class="flex-shrink-0">
                    <i class="fas fa-exclamation-circle text-red-400"></i>
                </div>
                <div class="ml-3">
                    <p class="text-sm text-red-700">{{ errorMessage }}</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Dashboard Content -->
    <div *ngIf="!isLoading && !errorMessage" class="px-4 sm:px-6 lg:px-8">

        <!-- HOD-style Stats Cards (for Assigned Tab) -->
        <div *ngIf="activeTab === 'assigned'" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-6 mb-6">
            <!-- Total Complaints -->
            <div
                class="rounded-xl border-l-4 border-indigo-500 shadow-md p-6 bg-white transition-all duration-300 hover:scale-105 hover:shadow-xl group cursor-pointer">
                <div class="flex justify-between items-center">
                    <div>
                        <p class="text-gray-500 text-xl font-medium mb-1">Total Complaints </p>
                        <h3 class="text-3xl font-bold text-gray-800 hodheading group-hover:animate-bounce">
                            {{ totalAssignedCreatedComplaints }}
                        </h3>
                    </div>
                    <div
                        class="relative p-3 rounded-full bg-indigo-100 text-indigo-600 transition-transform duration-300 group-hover:rotate-12">
                        <div
                            class="absolute inset-0 rounded-full bg-indigo-200 opacity-50 animate-ping z-0 group-hover:block hidden">
                        </div>
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 relative z-10" fill="none"
                            viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M9 5h6m-3-3v6m-5 4h10M5 7h14a2 2 0 012 2v10a2 2 0 01-2 2H5a2 2 0 01-2-2V9a2 2 0 012-2z" />
                        </svg>
                    </div>
                </div>
            </div>

            <!-- Open Complaints -->
            <div
                class="rounded-xl border-l-4 border-yellow-500 shadow-md p-6 bg-white transition-all duration-300 hover:scale-105 hover:shadow-xl group cursor-pointer">
                <div class="flex justify-between items-center">
                    <div>
                        <p class="text-gray-500 text-xl font-medium mb-1">Open Complaints</p>
                        <h3 class="text-3xl font-bold text-gray-800 hodheading group-hover:animate-bounce">
                            {{ createdAssignedOpenComplaints }}
                        </h3>
                    </div>
                    <div
                        class="relative p-3 rounded-full bg-yellow-100 text-yellow-600 transition-transform duration-300 group-hover:rotate-12">
                        <div
                            class="absolute inset-0 rounded-full bg-yellow-200 opacity-50 animate-ping z-0 group-hover:block hidden">
                        </div>
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 relative z-10" fill="none"
                            viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M12 9v2m0 4h.01M12 4a8 8 0 100 16 8 8 0 000-16z" />
                        </svg>
                    </div>
                </div>
            </div>

            <!-- In Progress Complaints -->
            <div
                class="rounded-xl border-l-4 border-orange-400 shadow-md p-6 bg-white transition-all duration-300 hover:scale-105 hover:shadow-xl group cursor-pointer">
                <div class="flex justify-between items-center">
                    <div>
                        <p class="text-gray-500 text-xl font-medium mb-1">In Progress</p>
                        <h3 class="text-3xl font-bold text-gray-800 hodheading group-hover:animate-bounce">
                            {{ createdAssignedPendingComplaints }}
                        </h3>
                    </div>
                    <div
                        class="relative p-3 rounded-full bg-orange-100 text-orange-500 transition-transform duration-300 group-hover:rotate-12">
                        <div
                            class="absolute inset-0 rounded-full bg-orange-200 opacity-50 animate-ping z-0 group-hover:block hidden">
                        </div>
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 relative z-10" fill="none"
                            viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                    </div>
                </div>
            </div>

            <!-- Resolved Complaints -->
            <!-- <div
                class="rounded-xl border-l-4 border-green-500 shadow-md p-6 bg-white transition-all duration-300 hover:scale-105 hover:shadow-xl group cursor-pointer">
                <div class="flex justify-between items-center">
                    <div>
                        <p class="text-gray-500 text-xl font-medium mb-1">Resolved</p>
                        <h3 class="text-3xl font-bold text-gray-800 hodheading group-hover:animate-bounce">
                            {{ createdAssignedResolvedComplaints }}
                        </h3>
                    </div>
                    <div
                        class="relative p-3 rounded-full bg-green-100 text-green-600 transition-transform duration-300 group-hover:rotate-12">
                        <div
                            class="absolute inset-0 rounded-full bg-green-200 opacity-50 animate-ping z-0 group-hover:block hidden">
                        </div>
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 relative z-10" fill="none"
                            viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                        </svg>
                    </div>
                </div>
            </div> -->

            <!-- Closed Complaints -->
            <div
                class="rounded-xl border-l-4 border-sky-500 shadow-md p-6 bg-white transition-all duration-300 hover:scale-105 hover:shadow-xl group cursor-pointer">
                <div class="flex justify-between items-center">
                    <div>
                        <p class="text-gray-500 text-xl font-medium mb-1">Closed</p>
                        <h3 class="text-3xl font-bold text-gray-800 hodheading group-hover:animate-bounce">
                            {{ createdAssignedClosedComplaints }}
                        </h3>
                    </div>
                    <div
                        class="relative p-3 rounded-full bg-sky-100 text-sky-600 transition-transform duration-300 group-hover:rotate-12">
                        <div
                            class="absolute inset-0 rounded-full bg-sky-200 opacity-50 animate-ping z-0 group-hover:block hidden">
                        </div>
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 relative z-10" fill="none"
                            viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                    </div>
                </div>
            </div>

            <!-- Average Resolution Time -->
            <div
                class="rounded-xl border-l-4 border-purple-500 shadow-md p-6 bg-white transition-all duration-300 hover:scale-105 hover:shadow-xl group cursor-pointer">
                <div class="flex justify-between items-center">
                    <div>
                        <p class="text-gray-500 text-xl font-medium mb-1">Avg Resolution</p>
                        <h3 class="text-3xl font-bold text-gray-800 hodheading group-hover:animate-bounce">
                            {{avgResponseAssignTime}}
                        </h3>
                    </div>
                    <div
                        class="relative p-3 rounded-full bg-purple-100 text-purple-600 transition-transform duration-300 group-hover:rotate-12">
                        <div
                            class="absolute inset-0 rounded-full bg-purple-200 opacity-50 animate-ping z-0 group-hover:block hidden">
                        </div>
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 relative z-10" fill="none"
                            viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M12 6v6l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                    </div>
                </div>
            </div>
        </div>

        <!-- User-style Stats Cards (for Created Tab) -->
        <div *ngIf="activeTab === 'created'" class="grid grid-cols-1 md:grid-cols-6 gap-6 mb-6">
            <!-- Total Complaints -->
            <div class="quick-stats-card bg-white rounded-lg shadow p-6 animate-fadeIn" style="animation-delay: 0.1s">
                <div class="flex items-center">
                    <div class="p-3 rounded-full bg-indigo-100 text-indigo-600 icon-circle z-10">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24"
                            stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                    </div>
                    <div class="ml-4 z-10">
                        <p class="text-sm font-medium text-gray-500">Total Complaints</p>
                        <p class="text-2xl font-semibold text-gray-800">{{ totalUserCreatedComplaints }}</p>
                    </div>
                </div>
            </div>

            <!-- Open Complaints -->
            <div class="quick-stats-card bg-white rounded-lg shadow p-6 animate-fadeIn" style="animation-delay: 0.2s">
                <div class="flex items-center">
                    <div class="p-3 rounded-full bg-red-100 text-red-600 icon-circle z-10">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24"
                            stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                        </svg>
                    </div>
                    <div class="ml-4 z-10">
                        <p class="text-sm font-medium text-gray-500">Open</p>
                        <p class="text-2xl font-semibold text-gray-800">{{ createdOpenComplaints }}</p>
                    </div>
                </div>
            </div>

            <!-- In Progress Complaints -->
            <div class="quick-stats-card bg-white rounded-lg shadow p-6 animate-fadeIn" style="animation-delay: 0.3s">
                <div class="flex items-center">
                    <div class="p-3 rounded-full bg-yellow-100 text-yellow-600 icon-circle z-10">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24"
                            stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                    </div>
                    <div class="ml-4 z-10">
                        <p class="text-sm font-medium text-gray-500">In Progress</p>
                        <p class="text-2xl font-semibold text-gray-800">{{ createdPendingComplaints }}</p>
                    </div>
                </div>
            </div>

            <!-- Resolved Complaints -->
            <!-- <div class="quick-stats-card bg-white rounded-lg shadow p-6 animate-fadeIn" style="animation-delay: 0.4s">
                <div class="flex items-center">
                    <div class="p-3 rounded-full bg-green-100 text-green-600 icon-circle z-10">
                        <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                        </svg>
                    </div>
                    <div class="ml-4 z-10">
                        <p class="text-sm font-medium text-gray-500">Resolved</p>
                        <p class="text-2xl font-semibold text-gray-800">{{ createdResolvedComplaints }}</p>
                    </div>
                </div>
            </div> -->

            <!-- Closed Complaints -->
            <div class="quick-stats-card bg-white rounded-lg shadow p-6 animate-fadeIn" style="animation-delay: 0.5s">
                <div class="flex items-center">
                    <div class="p-3 rounded-full bg-blue-100 text-blue-600 icon-circle z-10">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24"
                            stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                    </div>
                    <div class="ml-4 z-10">
                        <p class="text-sm font-medium text-gray-500">Closed</p>
                        <p class="text-2xl font-semibold text-gray-800">{{ createdClosedComplaints }}</p>
                    </div>
                </div>
            </div>

            <!-- Escalated Complaints -->
            <div class="quick-stats-card bg-white rounded-lg shadow p-6 animate-fadeIn" style="animation-delay: 0.6s">
                <div class="flex items-center">
                    <div class="p-3 rounded-full bg-purple-100 text-purple-600 icon-circle z-10">
                        <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M3 17l6-6 4 4 8-8M14 7h7v7" />
                        </svg>
                    </div>
                    <div class="ml-4 z-10">
                        <p class="text-sm font-medium text-gray-500">Escalated</p>
                        <p class="text-2xl font-semibold text-gray-800">{{ createdEscalatedComplaints}}</p>
                    </div>
                </div>
            </div>

            <!-- Average Response Time -->
            <div class="quick-stats-card bg-white rounded-lg shadow p-6 animate-fadeIn" style="animation-delay: 0.7s">
                <div class="flex items-center">
                    <div class="p-3 rounded-full bg-pink-100 text-pink-600 icon-circle z-10">
                        <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M12 6v6l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                    </div>
                    <div class="ml-4 z-10">
                        <p class="text-sm font-medium text-gray-500">Avg Response</p>
                        <p class="text-2xl font-semibold text-gray-800">{{ avgResponseTime }} hrs</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Charts Section -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">

            <div class="bg-white shadow rounded-lg border border-gray-200 overflow-hidden">
                <div class="px-5 py-4 border-b border-gray-200">
                    <h2 class="text-lg font-medium text-gray-800">Current Workload</h2>
                </div>
                <div class="p-5">
                    <div class="relative pt-1">
                        <div class="flex mb-2 items-center justify-between">
                            <div>
                                <span
                                    class="text-xs font-semibold inline-block py-1 px-2 uppercase rounded-full text-indigo-600 bg-indigo-200">
                                    Workload Progress
                                </span>
                            </div>
                            <div class="text-right">
                                <span class="text-xs font-semibold inline-block text-indigo-600">
                                    {{ activeTab === 'assigned' ? '70%' : '60%' }}
                                </span>
                            </div>
                        </div>
                        <div class="overflow-hidden h-2 mb-4 text-xs flex rounded bg-indigo-200">
                            <div [style.width]="activeTab === 'assigned' ? '70%' : '60%'"
                                class="shadow-none flex flex-col text-center whitespace-nowrap text-white justify-center bg-indigo-500">
                            </div>
                        </div>
                    </div>

                    <div class="mt-4 space-y-4">
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-500">Open Tasks</span>
                            <span class="text-sm font-medium text-gray-800">
                                {{ activeTab === 'assigned' ? createdAssignedOpenComplaints : createdOpenComplaints }}
                            </span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-500">In Progress</span>
                            <span class="text-sm font-medium text-gray-800">
                                {{ activeTab === 'assigned' ? createdAssignedPendingComplaints :
                                createdPendingComplaints }}
                            </span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-500">Closed</span>
                            <span class="text-sm font-medium text-gray-800">
                                {{ activeTab === 'assigned' ? createdAssignedClosedComplaints : createdClosedComplaints
                                }}
                            </span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-500">Resolved This Week</span>
                            <span class="text-sm font-medium text-gray-800">
                                {{ activeTab === 'assigned' ? '5' : '3' }}
                            </span>
                        </div>

                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-500">Avg. Resolution Time</span>
                            <span class="text-sm font-medium text-gray-800">
                                {{ activeTab === 'assigned' ? avgResponseAssignTime : avgResponseTime }} hrs
                            </span>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Status Chart -->
            <!-- <div class="bg-white shadow rounded-lg p-5 border border-gray-200">
                <h2 class="text-lg font-medium text-gray-800 mb-4">
                    {{ activeTab === 'created' ? 'My Created Complaints by Status' : 'Assigned Complaints by Status' }}
                </h2>
                <div class="h-80">
                    <canvas id="statusChart"></canvas>
                </div>
            </div> -->

            <!-- Priority Chart -->
            <div class="bg-white shadow rounded-lg p-5 border border-gray-200">
                <h2 class="text-lg font-medium text-gray-800 mb-4">Complaints by Priority</h2>
                <div class="h-80">
                    <!-- <canvas id="priorityChart"></canvas> -->
                    <canvas *ngIf="activeTab === 'created'" id="createdChart"></canvas>
                    <canvas *ngIf="activeTab === 'assigned'" id="assignedChart"></canvas>

                </div>
            </div>
            <!-- Monthly Trend Chart -->
            <div *ngIf="activeTab === 'created'" class="bg-white shadow rounded-lg p-5 border border-gray-200 mb-6">
                <h2 class="text-lg font-medium text-gray-800 mb-4">Monthly Complaint Trend</h2>
                <div class="h-80">
                    <canvas id="monthlyUserTrendChart"></canvas>
                </div>
            </div>
        </div>


        <!-- Recent Complaints Table -->
        <div class="bg-white shadow rounded-lg border border-gray-200 overflow-hidden">
            <div class="px-5 py-4 border-b border-gray-200">
                <h2 class="text-lg font-medium text-gray-800">
                    {{ activeTab === 'created' ? 'My Recent Complaints' : 'Recently Assigned Complaints' }}
                </h2>
            </div>

            <!-- Empty State -->
            <div *ngIf="(activeTab === 'created' && filteredCreatedComplaints.length === 0) || 
                 (activeTab === 'assigned' && filteredAssignedComplaints.length === 0)" class="p-10 text-center">
                <div class="mx-auto h-16 w-16 rounded-full bg-gray-100 flex items-center justify-center mb-4">
                    <i class="fas fa-inbox text-gray-400 text-2xl"></i>
                </div>
                <h3 class="text-lg font-medium text-gray-800 mb-1">No complaints found</h3>
                <p class="text-gray-500">
                    {{ activeTab === 'created' ?
                    'You haven\'t created any complaints yet.' :
                    'No complaints have been assigned to you yet.' }}
                </p>
                <button *ngIf="activeTab === 'created'"
                    class="mt-4 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors">
                    <i class="fas fa-plus mr-2"></i> Create New Complaint
                </button>
            </div>

            <!-- Table -->
            <div *ngIf="(activeTab === 'created' && filteredCreatedComplaints.length > 0) || 
                 (activeTab === 'assigned' && filteredAssignedComplaints.length > 0)" class="overflow-x-auto">
                <table class="min-w-full divide-y divide-gray-200">
                    <thead class="bg-gray-50">
                        <tr>
                            <th scope="col"
                                class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                ID
                            </th>
                            <th scope="col"
                                class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                Subject
                            </th>
                            <th scope="col"
                                class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                Status
                            </th>
                            <th scope="col"
                                class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                Priority
                            </th>
                            <th scope="col"
                                class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                                Created Date
                            </th>
                            <th scope="col"
                                class="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">
                                Actions
                            </th>
                        </tr>
                    </thead>
                    <tbody class="bg-white divide-y divide-gray-200">
                        <tr *ngFor="let complaint of 
      activeTab === 'created' 
        ? (showAllCreated ? filteredCreatedComplaints : filteredCreatedComplaints.slice(0, 5))
        : (showAllAssigned ? filteredAssignedComplaints : filteredAssignedComplaints.slice(0, 5))"
                            class="hover:bg-gray-50">

                            <!-- <tr *ngFor="let complaint of activeTab === 'created' ? 
                                         filteredCreatedComplaints.slice(0, 5) : 
                                         filteredAssignedComplaints.slice(0, 5)" class="hover:bg-gray-50"> -->
                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">
                                #{{ complaint.complaint_id }}
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                {{ complaint.subject | slice:0:40 }}{{ complaint.subject.length > 40 ?
                                '...' : '' }}
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <span class="px-2 py-1 rounded-md text-xs" [ngClass]="{
                                    'bg-yellow-100 text-yellow-600': complaint.status === 'ASSIGNED',
                                    'bg-blue-100 text-blue-600': complaint.status === 'IN_PROGRESS',
                                    'bg-gray-200 text-gray-600': complaint.status === 'OPEN',
                                    'bg-purple-100 text-purple-600': complaint.status === 'ESCALATED',
                                    'bg-green-100 text-green-600': complaint.status === 'RESOLVED',
                                    'bg-orange-100 text-orange-600': complaint.status === 'DEFERRED',
                                    'bg-pink-100 text-pink-600': complaint.status === 'REOPEN',
                                    'bg-red-100 text-red-600': complaint.status === 'CLOSED'
                  
                                  }">
                                    {{ complaint.status }}
                                </span>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap">
                                <span class="px-2 py-1 rounded-md text-xs" [ngClass]="{
                                    'bg-red-100 text-red-800': complaint.priority === 'HIGH',
                                    'bg-yellow-100 text-yellow-800': complaint.priority === 'MEDIUM',
                                    'bg-green-100 text-green-800': complaint.priority === 'LOW'
                                  }">
                                    {{ complaint.priority }}
                                </span>
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                                {{ complaint.created_on | date:'medium' }}
                            </td>
                            <td class="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                                <a class="text-indigo-600 hover:text-indigo-900 mr-3" [routerLink]="['/employee/complaints', complaint.complaint_id]">View</a>

                                  
                                <!-- <a href="" class="text-indigo-600 hover:text-indigo-900 mr-3" >View</a> -->
                                <a *ngIf="activeTab === 'assigned' && complaint.status !== 'CLOSED'" href="#"
                                    class="text-green-600 hover:text-green-900">Update</a>
                            </td>
                        </tr>
                    </tbody>
                </table>

                <!-- View All Link -->
                <!-- <div class="flex justify-center border-t border-gray-200 px-5 py-3">
                    <a href="#" class="text-indigo-600 hover:text-indigo-900 text-sm font-medium">
                        View All {{ activeTab === 'created' ? 'Created' : 'Assigned' }} Complaints
                        <i class="fas fa-arrow-right ml-1"></i>
                    </a>
                </div> -->
                <div class="flex justify-center border-t border-gray-200 px-5 py-3">
                    <a href="#" (click)="toggleViewAll($event)"
                        class="text-indigo-600 hover:text-indigo-900 text-sm font-medium">
                        {{ (activeTab === 'created' && !showAllCreated) ||
                        (activeTab === 'assigned' && !showAllAssigned)
                        ? 'View All' : 'Show Less' }}
                        {{ activeTab === 'created' ? ' Created' : ' Assigned' }} Complaints
                        <i class="fas fa-arrow-right ml-1"></i>
                    </a>
                </div>

            </div>
        </div>

        <!-- SLA Performance Section (Assigned tab only) -->
        <div *ngIf="activeTab === 'assigned'"
            class="mt-6 bg-white shadow rounded-lg border border-gray-200 overflow-hidden">
            <div class="px-5 py-4 border-b border-gray-200">
                <h2 class="text-lg font-medium text-gray-800">SLA Performance</h2>
            </div>

            <div class="p-5">
                <div class="flex flex-col md:flex-row md:items-center md:justify-between mb-6">
                    <div class="flex items-center mb-4 md:mb-0">
                        <div class="relative h-16 w-16">
                            <svg viewBox="0 0 36 36" class="circular-chart">
                                <path class="circle-bg" d="M18 2.0845
                  a 15.9155 15.9155 0 0 1 0 31.831
                  a 15.9155 15.9155 0 0 1 0 -31.831" />
                                <path class="circle" stroke-dasharray="85, 100" stroke="#4ade80" d="M18 2.0845
                  a 15.9155 15.9155 0 0 1 0 31.831
                  a 15.9155 15.9155 0 0 1 0 -31.831" />
                            </svg>
                            <div class="absolute inset-0 flex items-center justify-center">
                                <span class="text-xl font-bold text-gray-800">85%</span>
                            </div>
                        </div>
                        <div class="ml-4">
                            <h3 class="text-lg font-medium text-gray-800">SLA Compliance</h3>
                            <p class="text-sm text-gray-500">Average response time: 1.2 hours</p>
                        </div>
                    </div>

                    <div class="grid grid-cols-3 gap-4 mt-4 md:mt-0">
                        <div class="bg-green-50 p-3 rounded-lg text-center">
                            <div class="text-2xl font-bold text-green-700">92%</div>
                            <div class="text-xs text-gray-500">First Response</div>
                        </div>
                        <div class="bg-blue-50 p-3 rounded-lg text-center">
                            <div class="text-2xl font-bold text-blue-700">78%</div>
                            <div class="text-xs text-gray-500">Resolution</div>
                        </div>
                        <div class="bg-purple-50 p-3 rounded-lg text-center">
                            <div class="text-2xl font-bold text-purple-700">88%</div>
                            <div class="text-xs text-gray-500">Customer Satisfaction</div>
                        </div>
                    </div>
                </div>

                <!-- SLA Timeline -->
                <div class="mt-6">
                    <h3 class="text-sm font-medium text-gray-700 mb-3">Recent SLA Timeline</h3>
                    <div class="relative">
                        <!-- Vertical Timeline Line -->
                        <div class="absolute top-0 left-7 h-full w-0.5 bg-gray-200"></div>

                        <!-- Timeline Items -->
                        <div class="mb-6 relative flex items-start">
                            <div class="flex flex-col items-center">
                                <div
                                    class="z-10 flex items-center justify-center w-14 h-14 rounded-full bg-green-100 ring-8 ring-white">
                                    <i class="fas fa-check text-green-600 text-lg"></i>
                                </div>
                                <div class="text-xs font-medium text-gray-500 mt-1">30m</div>
                            </div>
                            <div class="ml-4 min-w-0 flex-1 bg-white rounded-lg border border-gray-200 shadow-sm p-4">
                                <div class="flex justify-between items-center mb-1">
                                    <h4 class="text-sm font-medium text-gray-900">First Response</h4>
                                    <span
                                        class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">
                                        <i class="fas fa-check-circle mr-1"></i> Within SLA
                                    </span>
                                </div>
                                <p class="text-xs text-gray-500">Responded to complaint #1234 within 30 minutes of
                                    creation.</p>
                            </div>
                        </div>

                        <div class="mb-6 relative flex items-start">
                            <div class="flex flex-col items-center">
                                <div
                                    class="z-10 flex items-center justify-center w-14 h-14 rounded-full bg-blue-100 ring-8 ring-white">
                                    <i class="fas fa-tools text-blue-600 text-lg"></i>
                                </div>
                                <div class="text-xs font-medium text-gray-500 mt-1">2h</div>
                            </div>
                            <div class="ml-4 min-w-0 flex-1 bg-white rounded-lg border border-gray-200 shadow-sm p-4">
                                <div class="flex justify-between items-center mb-1">
                                    <h4 class="text-sm font-medium text-gray-900">Investigation Started</h4>
                                    <span
                                        class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800">
                                        <i class="fas fa-clock mr-1"></i> In Progress
                                    </span>
                                </div>
                                <p class="text-xs text-gray-500">Started investigating the technical issue reported in
                                    complaint #1234.</p>
                            </div>
                        </div>

                        <div class="relative flex items-start">
                            <div class="flex flex-col items-center">
                                <div
                                    class="z-10 flex items-center justify-center w-14 h-14 rounded-full bg-yellow-100 ring-8 ring-white">
                                    <i class="fas fa-hourglass-half text-yellow-600 text-lg"></i>
                                </div>
                                <div class="text-xs font-medium text-gray-500 mt-1">4h</div>
                            </div>
                            <div class="ml-4 min-w-0 flex-1 bg-white rounded-lg border border-gray-200 shadow-sm p-4">
                                <div class="flex justify-between items-center mb-1">
                                    <h4 class="text-sm font-medium text-gray-900">Resolution Due</h4>
                                    <span
                                        class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800">
                                        <i class="fas fa-exclamation-triangle mr-1"></i> 2h Remaining
                                    </span>
                                </div>
                                <p class="text-xs text-gray-500">Resolution for complaint #1234 is due in 2 hours based
                                    on priority SLA.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Productivity Insights (for both tabs) -->
        <div class="mt-6 grid grid-cols-1 lg:grid-cols-3 gap-6">
            <!-- Workload Distribution -->
            <div class="bg-white shadow rounded-lg border border-gray-200 overflow-hidden">
                <div class="px-5 py-4 border-b border-gray-200">
                    <h2 class="text-lg font-medium text-gray-800">Current Workload</h2>
                </div>
                <div class="p-5">
                    <div class="relative pt-1">
                        <div class="flex mb-2 items-center justify-between">
                            <div>
                                <span
                                    class="text-xs font-semibold inline-block py-1 px-2 uppercase rounded-full text-indigo-600 bg-indigo-200">
                                    Workload Progress
                                </span>
                            </div>
                            <div class="text-right">
                                <span class="text-xs font-semibold inline-block text-indigo-600">
                                    {{ activeTab === 'assigned' ? '70%' : '60%' }}
                                </span>
                            </div>
                        </div>
                        <div class="overflow-hidden h-2 mb-4 text-xs flex rounded bg-indigo-200">
                            <div [style.width]="activeTab === 'assigned' ? '70%' : '60%'"
                                class="shadow-none flex flex-col text-center whitespace-nowrap text-white justify-center bg-indigo-500">
                            </div>
                        </div>
                    </div>

                    <div class="mt-4 space-y-4">
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-500">Open Tasks</span>
                            <span class="text-sm font-medium text-gray-800">
                                {{ activeTab === 'assigned' ? createdAssignedOpenComplaints : createdOpenComplaints }}
                            </span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-500">In Progress</span>
                            <span class="text-sm font-medium text-gray-800">
                                {{ activeTab === 'assigned' ? createdAssignedPendingComplaints :
                                createdPendingComplaints }}
                            </span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-500">Closed</span>
                            <span class="text-sm font-medium text-gray-800">
                                {{ activeTab === 'assigned' ? createdAssignedClosedComplaints : createdClosedComplaints
                                }}
                            </span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-500">Resolved This Week</span>
                            <span class="text-sm font-medium text-gray-800">
                                {{ activeTab === 'assigned' ? '5' : '3' }}
                            </span>
                        </div>

                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-500">Avg. Resolution Time</span>
                            <span class="text-sm font-medium text-gray-800">
                                {{ activeTab === 'assigned' ? avgResponseAssignTime : avgResponseTime }} hrs
                            </span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Quick Actions -->
            <div class="bg-white shadow rounded-lg border border-gray-200 overflow-hidden">
                <div class="px-5 py-4 border-b border-gray-200">
                    <h2 class="text-lg font-medium text-gray-800">Quick Actions</h2>
                </div>
                <div class="p-5">
                    <div class="space-y-3">
                        <button  (click)="navigateToNewComplaint()"
                            class="w-full flex items-center justify-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                            <i class="fas fa-plus mr-2"></i> New Complaint
                        </button>
                        <!-- href="/employee/create-complaints" -->
                        <button *ngIf="activeTab === 'assigned'"
                            class="w-full flex items-center justify-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500">
                            <i class="fas fa-check-circle mr-2"></i> Resolve Next Complaint
                        </button>

                        <button *ngIf="activeTab === 'created'"
                            class="w-full flex items-center justify-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">
                            <i class="fas fa-search mr-2"></i> Track Complaint Status
                        </button>

                        <button
                            class="w-full flex items-center justify-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                            <i class="fas fa-file-export mr-2"></i> Export Reports
                        </button>
                    </div>

                    <div class="mt-5 pt-5 border-t border-gray-200">
                        <h3 class="text-sm font-medium text-gray-700 mb-3">Help Resources</h3>
                        <div class="space-y-2">
                            <a href="#" class="block text-sm text-indigo-600 hover:text-indigo-900">
                                <i class="fas fa-book mr-2"></i> How to manage complaints
                            </a>
                            <a href="#" class="block text-sm text-indigo-600 hover:text-indigo-900">
                                <i class="fas fa-question-circle mr-2"></i> SLA compliance guide
                            </a>
                            <a href="#" class="block text-sm text-indigo-600 hover:text-indigo-900">
                                <i class="fas fa-video mr-2"></i> Video tutorial
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Notifications/Updates -->
            <div class="bg-white shadow rounded-lg border border-gray-200 overflow-hidden">
                <div class="px-5 py-4 border-b border-gray-200 flex justify-between items-center">
                    <h2 class="text-lg font-medium text-gray-800">Recent Updates</h2>
                    <span
                        class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800">
                        3 New
                    </span>
                </div>
                <div class="p-5">
                    <div class="flow-root">
                        <ul class="-mb-8">
                            <li class="relative pb-8">
                                <div class="relative flex space-x-3">
                                    <div>
                                        <span
                                            class="h-8 w-8 rounded-full bg-blue-500 flex items-center justify-center ring-8 ring-white">
                                            <i class="fas fa-comment-alt text-white"></i>
                                        </span>
                                    </div>
                                    <div class="min-w-0 flex-1 pt-1.5 flex justify-between space-x-4">
                                        <div>
                                            <p class="text-sm text-gray-800">New comment on <span
                                                    class="font-medium text-gray-900">Complaint #1234</span></p>
                                            <p class="text-xs text-gray-500 mt-1">From: John Doe</p>
                                        </div>
                                        <div class="text-right text-xs whitespace-nowrap text-gray-500">
                                            <time datetime="2023-01-23T13:23">30m ago</time>
                                        </div>
                                    </div>
                                </div>
                            </li>

                            <li class="relative pb-8">
                                <div class="relative flex space-x-3">
                                    <div>
                                        <span
                                            class="h-8 w-8 rounded-full bg-green-500 flex items-center justify-center ring-8 ring-white">
                                            <i class="fas fa-check text-white"></i>
                                        </span>
                                    </div>
                                    <div class="min-w-0 flex-1 pt-1.5 flex justify-between space-x-4">
                                        <div>
                                            <p class="text-sm text-gray-800">Complaint <span
                                                    class="font-medium text-gray-900">#4567</span> was marked as
                                                resolved</p>
                                            <p class="text-xs text-gray-500 mt-1">By: Jane Smith</p>
                                        </div>
                                        <div class="text-right text-xs whitespace-nowrap text-gray-500">
                                            <time datetime="2023-01-23T10:23">3h ago</time>
                                        </div>
                                    </div>
                                </div>
                            </li>

                            <li class="relative pb-8">
                                <div class="relative flex space-x-3">
                                    <div>
                                        <span
                                            class="h-8 w-8 rounded-full bg-yellow-500 flex items-center justify-center ring-8 ring-white">
                                            <i class="fas fa-bell text-white"></i>
                                        </span>
                                    </div>
                                    <div class="min-w-0 flex-1 pt-1.5 flex justify-between space-x-4">
                                        <div>
                                            <p class="text-sm text-gray-800">SLA deadline approaching for <span
                                                    class="font-medium text-gray-900">Complaint #2580</span></p>
                                            <p class="text-xs text-gray-500 mt-1">Due in: 4 hours</p>
                                        </div>
                                        <div class="text-right text-xs whitespace-nowrap text-gray-500">
                                            <time datetime="2023-01-23T09:23">6h ago</time>
                                        </div>
                                    </div>
                                </div>
                            </li>

                            <li class="relative">
                                <div class="relative flex space-x-3">
                                    <div>
                                        <span
                                            class="h-8 w-8 rounded-full bg-purple-500 flex items-center justify-center ring-8 ring-white">
                                            <i class="fas fa-tasks text-white"></i>
                                        </span>
                                    </div>
                                    <div class="min-w-0 flex-1 pt-1.5 flex justify-between space-x-4">
                                        <div>
                                            <p class="text-sm text-gray-800">New complaint <span
                                                    class="font-medium text-gray-900">#7890</span> assigned to you</p>
                                            <p class="text-xs text-gray-500 mt-1">Priority: High</p>
                                        </div>
                                        <div class="text-right text-xs whitespace-nowrap text-gray-500">
                                            <time datetime="2023-01-22T14:23">1d ago</time>
                                        </div>
                                    </div>
                                </div>
                            </li>
                        </ul>
                    </div>
                    <div class="mt-6 text-center">
                        <a href="#" class="text-sm font-medium text-indigo-600 hover:text-indigo-900">
                            View all updates
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    .circular-chart {
        height: 100%;
        width: 100%;
    }

    .circle-bg {
        fill: none;
        stroke: #eee;
        stroke-width: 3.8;
    }

    .circle {
        fill: none;
        stroke-width: 3.8;
        stroke-linecap: round;
        animation: progress 1s ease-out forwards;
    }

    @keyframes progress {
        0% {
            stroke-dasharray: 0 100;
        }
    }

    .hodheading {
        font-weight: bold;
        font-size: 20px;
    }

    /* Quick stats card animation */
    .animate-fadeIn {
        opacity: 0;
        animation: fadeIn 0.8s ease forwards;
    }

    @keyframes fadeIn {
        from {
            opacity: 0;
            transform: translateY(20px);
        }

        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .quick-stats-card {
        transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        border-radius: 12px;
        position: relative;
        overflow: hidden;
    }

    .quick-stats-card:hover {
        transform: translateY(-7px) scale(1.02);
        box-shadow: 0 15px 30px rgba(0, 0, 0, 0.15);
    }

    .icon-circle {
        transition: all 0.4s ease;
    }

    .quick-stats-card:hover .icon-circle {
        transform: rotate(10deg) scale(1.1);
    }
</style>